<% if @search %>
  <h1>Results for <%= @search %></h1>
<% else %>
  <h1>Listing pages</h1>
<% end %>

<table class="table table-bordered">
  <tr>
    <th>Name</th>
    <th>Slug</th>
    <th>Content</th>
	<th>Comments</th>
    <% if user_signed_in? %>
	  <th style="width: 90px;"></th>
	<% end %>
  </tr>

<% @pages.each do |page| %>
  <tr>
    <td><%= link_to page.name, nested_page_path(page) %></td>
    <td><%= page.slug %></td>
    <td><%= truncate( page.content, :length => 90, :omission => '...') %></td>
	<td><%= page.comments.count %></td>
	<% if user_signed_in? %>
      <td style="text-align: right;">
	  	<%= link_to 'Edit', nested_page_path(page) + '/edit', :class => "btn btn-mini" %> 
		<%= link_to 'Delete', page, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-danger btn-mini" %>
	  </td>
    </tr>
    <% end %>
<% end %>
</table>

<br />

<% if user_signed_in? %>
<%= link_to 'New Page', new_page_path, :class => 'btn btn-primary' %>
<% end %>

